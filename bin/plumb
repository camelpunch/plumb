#!/usr/bin/env ruby

require 'json'
require_relative '../lib/plumb/domain/build'
require_relative '../lib/plumb/domain/pipeline'
require_relative '../lib/plumb/domain/job'
require_relative '../lib/plumb/domain/script'
require_relative '../lib/plumb/domain/git_repository'
require_relative '../lib/plumb/domain/pipeline_runner'
require_relative '../lib/plumb/infrastructure/mailer'

module Plumb
  class Main
    def call
      Domain::Pipeline.parse(
        JSON.parse($stdin.read)
      ).run
    end
  end
end
Plumb::Main.new.call
